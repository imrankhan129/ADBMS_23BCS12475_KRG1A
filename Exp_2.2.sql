USE ADBMS_2027;

CREATE TABLE YEAR_TBL(ID INT PRIMARY KEY, YEAR INT, NPV INT);
CREATE TABLE QUERIES_TBL(ID INT, YEAR INT, FOREIGN KEY (ID) REFERENCES YEAR_TBL(ID));

SELECT * FROM YEAR_TBL;
SELECT * FROM QUERIES_TBL;
INSERT INTO YEAR_TBL (ID,YEAR,NPV)
VALUES
(1, 2018, 130),        
(2, 2016, 150),
(6, 2008, 100),
(12, 2019, 140),
(3, 2004, 120);

INSERT INTO QUERIES_TBL (ID,YEAR)
VALUES
(1, 2018),        
(2, 2017),
(6, 2008),
(12, 2018),
(3, 2004);

SELECT 
    Q.ID AS Query_ID,
    Q.YEAR AS Query_Year,
    ISNULL(Y.NPV,0) AS NPV
FROM 
    QUERIES_TBL Q
LEFT JOIN 
    YEAR_TBL Y 
    ON Q.ID = Y.ID AND Q.YEAR = Y.YEAR
ORDER BY 
    Q.ID;
